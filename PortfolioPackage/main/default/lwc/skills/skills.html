<!-- Objects required: 
Custom_Skills__c
Category__c
project
experience
equivalency


Author: Gabriel Anton
Date: 3/18/22
Description: The skills matrix displays the skill categories corresponding to the user
and gives the user the ability to add new categories as well as update their skills 

Each Edit and Add button opens modals where they can edit their skills or add a new category.

Edit: For now, Account data is being used for testing, but an Apex Controller will be used
to query the specific skills onto the page as well as give the category name

We should add a new field called category if it's not already there that will only be present
on the Add New Category Modal. 
-->

<template>

<div class="matrixContainer">

    <div class="headerContainer">

    <h1 class="slds-float_left slds-text-heading_large">Skills Matrix</h1>
    
    <button class="slds-button slds-button_icon slds-button_icon-inverse slds-float_right" title="Add Category" onclick={openModal}>
       <lightning-icon icon-name="utility:add"
            alternative-text="add"
            variant="inverse"
            size="medium" 
            class="icon"></lightning-icon>
            <span class="slds-assistive-text">Add Category</span>
    </button>

    <button class="slds-button slds-button_icon slds-button_icon-inverse slds-float_right" title="Add Skill" onclick={openSkillsModal}>
        <lightning-icon icon-name="utility:edit"
             alternative-text="add"
             variant="inverse"
             size="medium" 
             class="icon"></lightning-icon>
             <span class="slds-assistive-text">Add Skill</span>
     </button>

    </div>
    
    <br>
    <hr>
    <br>
    

    <div class="categoryContainer" style="display:flex; justify-content: normal; flex-wrap: wrap; margin-right:1.5em;">

    <!-- <div class="slds-grid slds-gutters">

        <div class="slds-col"> -->
        <!-- <lightning-card class="card-body"> -->
            <template if:true={category}>
                
                
                    <template for:each={category} for:item="titan">
                        <div key={titan.Id} class="recordContainer">
                        <header key={titan.Id} class="recordHeader">
                            {titan.Name} 
                         
                         <button class="slds-button slds-button_icon slds-button_icon-inverse slds-float_right" title="Delete" onclick={handleDelete} value={titan.Id}>
                            <lightning-icon icon-name="utility:delete"
                                 alternative-text="delete"
                                 variant="inverse"
                                 size="x-small" 
                                 class="headericon"
                                 value={titan.Id}></lightning-icon>
                                 <span class="slds-assistive-text">Delete</span>
                         </button>
                       
                        </header>

                        
                        <template for:each={titan.Custom_Skills__r} for:item="skill">
                            <ul key={skill.Id}>
                                <li key={skill.Id}><b>{skill.Skill_Number__c}: </b> {skill.Name} </li>
                                <!-- <li key={skill.Id}><b>Skill Number:</b> {skill.Skill_Number__c} </li> -->
                            </ul>
                        </template>

                    

                        </div>
                    </template>
                
                <br>
                <br>
                <br>
                
            </template>
        <!-- </lightning-card> -->
        <br>
        <br>
        <br>
    <!-- </div>

    </div> -->
    
    </div>
    <br>
    <br>
    <br>


</div>
    
    
 

    <!-- This is where the category modal begins -->

    <template if:true={isModalOpen}>
        <section aria-modal="true" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container ">
                <header class="slds-modal__header">
                    <h2 class="slds-text-heading_small">Add New Skill Category</h2>
                    <lightning-icon class="slds-modal__close" icon-name="utility:close" size="small" onclick={closeModal}></lightning-icon>
                </header>
                <!-- <div class="slds-modal__content">
                    <div class="slds-p-around_small">
                    </div>
                </div> -->
                <div class="slds-box slds-theme_default slds-var-p-around_medium">
                    <lightning-record-edit-form object-api-name={categoryObject} onsuccess={handleSuccess}>
                        <lightning-input-field field-name={categoryName}></lightning-input-field>
                        <!-- <lightning-input-field field-name={technology}></lightning-input-field> -->
                        <br>
                        <lightning-button variant="brand" type="submit" label="Add Category"></lightning-button>
                    </lightning-record-edit-form>
                </div>
                
                <footer class="slds-modal__footer">
                    <lightning-button variant="brand" label="Cancel" onclick={closeModal} class="slds-p-around_x-small"></lightning-button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>




     <!-- This is where the skills modal begins -->

     <template if:true={isSkillsModalOpen}>
        <section aria-modal="true" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container ">
                <header class="slds-modal__header">
                    <h2 class="slds-text-heading_small">Add New Skill</h2>
                    <lightning-icon class="slds-modal__close" icon-name="utility:close" size="small" onclick={closeSkillsModal}></lightning-icon>
                </header>
                <div class="slds-modal__content">
                </div>
                <div class="slds-box slds-theme_default slds-var-p-around_medium">
                    <lightning-record-edit-form object-api-name={objectName} onsuccess={handleSuccess}>
                        <lightning-input-field field-name={nameField}></lightning-input-field>
                        <lightning-input-field field-name={skillcategory}></lightning-input-field>
                        <br>
                        <lightning-button variant="brand" type="submit" label="Submit Skill"></lightning-button>
                    </lightning-record-edit-form>
                </div>
                <footer class="slds-modal__footer">
                    <lightning-button variant="brand" label="Cancel" onclick={closeSkillsModal} class="slds-p-around_x-small"></lightning-button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>




</template>